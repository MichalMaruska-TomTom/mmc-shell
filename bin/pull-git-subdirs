#! /usr/bin/zsh -f

setopt extendedglob

gitoptions="--no-pager"
git=(git $gitoptions)


remote=origin
foreach dir (^build-area(/)) {
    cd $dir
    if [ -d .git ];
    then
	cecho blue -n "===" $dir "==="
	if ${git} remote |grep $remote > /dev/null;
	then
	    echo
	    if ${git} status --short;
	    then
		cecho green -n "pulling from ";${git} remote show $remote|grep 'Fetch URL'
		${git} pull $remote master
		${git} fetch --tags $remote
	    else
		cecho red $dir is not clean!
	    fi
	else
	    cecho yellow ... is not associated with any $remote
	fi
    else
	cecho blue $dir  is not Git
    fi
    cd -
}